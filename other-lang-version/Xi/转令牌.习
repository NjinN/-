#包含 "习语言系统.接口"

#包含 "原生令牌.习"

令牌 字符串转令牌(字符 *词, 容器 *境, 自然数 行号){
	
	令牌 *原生令牌 = 转原生令牌(词, 境, 行号);
	如果(原生令牌 不等于 空指针){
		返回 *原生令牌;	
	} 
	
	令牌 令;
	字符 *字面值 = 内存申请并清零(字符串长度(词) + 1);
	
	/*******  字符串类型   ***********/
	如果(判断头串(词, "\"")){
		令.类型 = _字符串;
		内存复制(词 + 1, 字面值, 字符串长度(词) - 2 );
		令.值空间.字面值 = 字面值;
		令.境 = 境;
		令.句长 = 1;
		令.行号 = 行号;
		返回 令;
	}
	
	如果(判断头串(词, "\“")){
		令.类型 = _字符串;
		内存复制(词 + 2, 字面值, 字符串长度(词) - 4 );
		令.值空间.字面值 = 字面值;
		令.境 = 境;
		令.句长 = 1;
		令.行号 = 行号;
		返回 令;
	}
	
	/******** 整数类型 ***********/
	如果(判断数字串(词) 等于 0){
		令.类型 = _整数;
		令.值空间.数字 = 字符串转整数(词, 10, 空指针); 
		令.境 = 境;
		令.句长 = 1;
		令.行号 = 行号;
		返回 令;	
	}
	
	/******* 小数类型 ***********/
	如果(判断数字串(词) 等于 1){
		令.类型 = _小数;
		令.值空间.浮点 = 字符串转浮点数(词, 空指针); 
		令.境 = 境;
		令.句长 = 1;
		令.行号 = 行号;
		返回 令;	
	}
	
	/******* 设字类型 **********/
	如果(判断尾串(词, ":")){
		令.类型 = _设字;
		内存复制(词, 字面值, 字符串长度(词) - 1 );
		令.值空间.字面值 = 字面值;
		令.境 = 境;
		令.句长 = 2;
		令.行号 = 行号;
		返回 令;
	}
	
	如果(判断尾串(词, "：")){
		令.类型 = _设字;
		内存复制(词, 字面值, 字符串长度(词) - 2 );
		令.值空间.字面值 = 字面值;
		令.境 = 境;
		令.句长 = 2;
		令.行号 = 行号;
		返回 令;
	}
	
	/******* 原字类型 *********/
	如果(判断头串(词, "'")){
		令.类型 = _原字;
		内存复制(词 + 1, 字面值, 字符串长度(词) - 1 );
		令.值空间.字面值 = 字面值;
		令.境 = 境;
		令.句长 = 1;
		令.行号 = 行号;
		返回 令;
	}
	
	如果(判断头串(词, "‘") 或 判断头串(词, "’")){
		令.类型 = _原字;
		内存复制(词 + 2, 字面值, 字符串长度(词) - 2 );
		令.值空间.字面值 = 字面值;
		令.境 = 境;
		令.句长 = 1;
		令.行号 = 行号;
		返回 令;
	}
	
	
	/******* 单字类型 *********/
	令.类型 = _单字;
	内存复制(词, 字面值, 字符串长度(词) );
	令.值空间.字面值 = 字面值;
	令.境 = 境;
	令.句长 = 1;
	令.行号 = 行号;
	返回 令;
}

/*
无类型 主函数(){
	令牌 令 = 字符串转令牌("'ibgl", 空指针, 1);	
	输出整数(令.类型, 10);
	换行();
	输出字符串并换行(令.值空间.字面值);
	暂停();
}
*/