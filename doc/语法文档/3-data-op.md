
---
### 数据操作

RML中变量和变量名是一种绑定关系，记录在语境中。语境的底层是一个键为字符串，值为Token引用的哈希表。
值的绑定通过 `设字` 类型来实现

```
name: 123
```
设字类型以 `:` 结尾，`:` 之前的部分为变量名。
设字进行值绑定时会首先检查当前语境中是否已有对应的绑定，若当前语境不存在绑定，则沿语境树向上查找。当发现已有绑定时，更新该语境中变量名绑定的值。若向上检查完毕，确定之前未有绑定，则返回当前语境，在当前语境中执行值的绑定。

```
name:= 123
``` 
置字类型以 `:=` 结尾， `:=` 之前的部分为变量名。
置字类型与设字类型的绑定操作的区别为，置字类型向上查找的范围限于最近的一个用户类型语境，语境分为系统语境、用户语境、临时语境，其中临时语境只有用在控制流中。置字类型可用于设置局部变量，而不会影响上层语境。

完成值的绑定后，可通过单字类型来回去对应的值。

```
name     ;返回 123
```
单字类型对应的是变量名。当解释器接收到一个单字类型的Token，会沿着语境树向上查找，返回找到的最近的一个绑定的值。若查找不到对应的绑定，则返回一个 `none` 值。

对于集合类型中成员的操作可通过路径类型来实现

```
blk: [1 2 3]
blk/2			;返回 2
```
路径类型使用 `/` 来表示层级关系，对于方块类型，可以通过序号获取对应的成员。

```
blk/2: 5
blk				;返回 [1 5 3]
```
当路径类型以 `:` 结尾时，用于修改集合内部的值

另外方块类型可以模拟map的行为，例如

```
blk: [name "Ada" age 10]
blk/age			;返回 10 
```
若方块类型的成员索引不是整数类型时，会依次比对方块中各个成员与索引的字面值是否一致，若一致则返回其后的一个成员。同样可以通过这种方式修改集合内部的成员。

```
blk/age: 20
blk				;返回 [name "Ada" age 20]
```
注意这种操作方式的性能会随着方块长度的增长而边慢，不应该在长方块中使用，有相关需求的请使用哈希表 `map!` 类型。

对于对象类型、哈希表类型的操作与方块类型一致，例如

```
obj: {a: 1 b: 2}
obj/a			;返回 1
obj/a: 5
obj 			;返回 {a: 5 b: 2}

map: !map{[1 "Hello"] [2 "world"]}
map/2			;返回 "world"
map/2: "rml"
map			;返回 !map{[1 "Hello"] [2 "rml"]}
```

对于哈希表类型，如果索引的值是复制的类型时，可使用 `put` 和 `get` 函数来进行存取操作

```
get map 1		;返回 "Hello"
put map 1 "RML"		
map				;返回 !map{[1 "Hello"] [2 "RML"]}
```

另外，字符串类型也可以通过序号进行操作

```
str: "12345"
str/3			;返回 #'3'
str/3: #'9'
str				;返回 "12945"
```

























